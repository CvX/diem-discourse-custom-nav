<script type="text/discourse-plugin" version="0.8.20">
  const customHeaderLinks = settings.Custom_header_links;

  if (!customHeaderLinks.length) return;

  const h = require("virtual-dom").h;
  const headerLinks = [];

  customHeaderLinks.split("|").map(i => {
    const seg = $.map(i.split(","), $.trim);
    const linkText = seg[0];
    const linkTitle = seg[1];
    const linkHref = seg[2];
    const userClass = `.${seg[3]}`;
    const linkTarget = seg[4] === "self" ? "" : "_blank";
    const keepOnScrollClass = seg[5] === "keep" ? ".keep" : "";
    const linkClass = `.${linkText.trim().toLowerCase().replace(/\s/gi, '-')}`;

    if (!linkTarget) {
      headerLinks.push(
        h(
          `li${userClass}${keepOnScrollClass}${linkClass}`,
          h(
            "a.nav-link",
            {
              title: linkTitle,
              href: linkHref
            },
            linkText
          )
        )
      );
    } else {
      headerLinks.push(
        h(
          `li${userClass}${keepOnScrollClass}${linkClass}`,
          h(
            "a.nav-link",
            {
              title: linkTitle,
              href: linkHref,
              target: linkTarget
            },
            linkText
          )
        )
      );
    }
  });

  api.decorateWidget("header-buttons:before", helper => {
    return helper.h(
      'ul.nav-link-container', [
          helper.h('li.nav-link-title.members', [
            helper.h('a.nav-link', {
                href:'/c/member-portal', 
                text:'Member Portal',
                target:'_self'
            }) 
          ]),
          helper.h('li.nav-link-title.public', [
            helper.h('a.nav-link', {
                href:'/', 
                text:'Developers',
                target:'_self'
            }) 
          ]),
          headerLinks
      ]
    );
  });

  api.decorateWidget("home-logo:after", helper => {
    let titleVisible = helper.attrs.minimized;
    if (titleVisible) {
      $(".d-header").addClass("hide-menus");
    } else {
      $(".d-header").removeClass("hide-menus");
    }
  });
</script>